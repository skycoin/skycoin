{"version":3,"file":"location.js","sourceRoot":"","sources":["../../../../../modules/@angular/common/src/location/location.ts"],"names":[],"mappings":";AAIE,qBAAiC,eAAe,CAAC,CAAA;AACnD,sBAA8C,wBAAwB,CAAC,CAAA;AAEvE,kCAA+B,qBAAqB,CAAC,CAAA;AACrD;IAME,kBAAmB,gBAAkC;QANvD,iBA4HC;QAtHoB,qBAAgB,GAAhB,gBAAgB,CAAkB;QALrD,gBAAgB;QAChB,aAAQ,GAAsB,IAAI,oBAAY,EAAE,CAAC;QAK/C,IAAI,eAAe,GAAG,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,CAAC;QAC1D,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,kBAAkB,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC,CAAC;QAC/E,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,UAAC,EAAE;YAClC,yBAAiB,CAAC,QAAQ,CAAC,KAAI,CAAC,QAAQ,EAAE,EAAC,KAAK,EAAE,KAAI,CAAC,IAAI,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,CAAC,IAAI,EAAC,CAAC,CAAC;QAChG,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;OAEG;IACH,uBAAI,GAAJ,cAAiB,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;IAEvE;;;OAGG;IACH,4BAAS,GAAT,UAAU,GAAW;QACnB,MAAM,CAAC,QAAQ,CAAC,kBAAkB,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,EAAE,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAC3F,CAAC;IAED;;;;;OAKG;IACH,qCAAkB,GAAlB,UAAmB,GAAW;QAC5B,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAC3C,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;QAClB,CAAC;QACD,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,GAAG,CAAC,CAAC;IACvD,CAAC;IAED,wCAAwC;IACxC;;;OAGG;IACH,qBAAE,GAAF,UAAG,IAAY,EAAE,KAAkB;QAAlB,qBAAkB,GAAlB,UAAkB;QACjC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IACzD,CAAC;IAED;;;OAGG;IACH,+BAAY,GAAZ,UAAa,IAAY,EAAE,KAAkB;QAAlB,qBAAkB,GAAlB,UAAkB;QAC3C,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;IAC5D,CAAC;IAED;;OAEG;IACH,0BAAO,GAAP,cAAkB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;IAEpD;;OAEG;IACH,uBAAI,GAAJ,cAAe,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IAE9C;;OAEG;IACH,4BAAS,GAAT,UAAU,MAA4B,EAAE,OAAwC,EACtE,QAA2B;QADG,uBAAwC,GAAxC,cAAwC;QACtE,wBAA2B,GAA3B,eAA2B;QACnC,MAAM,CAAC,yBAAiB,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IAC/E,CAAC;IAED;;;OAGG;IACW,6BAAoB,GAAlC,UAAmC,MAAc;QAC/C,MAAM,CAAC,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,MAAM,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,MAAM,CAAC;IACxF,CAAC;IAED;;OAEG;IACW,sBAAa,GAA3B,UAA4B,KAAa,EAAE,GAAW;QACpD,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC;YACtB,MAAM,CAAC,GAAG,CAAC;QACb,CAAC;QACD,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,CAAC,KAAK,CAAC;QACf,CAAC;QACD,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,EAAE,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACxB,OAAO,EAAE,CAAC;QACZ,CAAC;QACD,EAAE,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACxB,OAAO,EAAE,CAAC;QACZ,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;YACjB,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAClC,CAAC;QACD,EAAE,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;YACjB,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC;QACrB,CAAC;QACD,MAAM,CAAC,KAAK,GAAG,GAAG,GAAG,GAAG,CAAC;IAC3B,CAAC;IAED;;OAEG;IACW,2BAAkB,GAAhC,UAAiC,GAAW;QAC1C,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACrB,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;QACzC,CAAC;QACD,MAAM,CAAC,GAAG,CAAC;IACb,CAAC;IACI,mBAAU,GAA0B;QAC3C,EAAE,IAAI,EAAE,iBAAU,EAAE;KACnB,CAAC;IACK,uBAAc,GAA2D;QAChF,EAAC,IAAI,EAAE,oCAAgB,GAAG;KACzB,CAAC;IACF,eAAC;AAAD,CAAC,AA5HD,IA4HC;AA5HY,gBAAQ,WA4HpB,CAAA;AAED,wBAAwB,QAAgB,EAAE,GAAW;IACnD,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACxC,CAAC;IACD,MAAM,CAAC,GAAG,CAAC;AACb,CAAC;AAED,yBAAyB,GAAW;IAClC,EAAE,CAAC,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/B,6BAA6B;QAC7B,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;IAC3C,CAAC;IACD,MAAM,CAAC,GAAG,CAAC;AACb,CAAC","sourcesContent":["interface DecoratorInvocation {\n    type: Function;\n    args?: any[];\n  }\n  import {Injectable, Inject} from '@angular/core';\nimport {EventEmitter, ObservableWrapper} from '../../src/facade/async';\n\nimport {LocationStrategy} from './location_strategy';\nexport class Location {\n  /** @internal */\n  _subject: EventEmitter<any> = new EventEmitter();\n  /** @internal */\n  _baseHref: string;\n\n  constructor(public platformStrategy: LocationStrategy) {\n    var browserBaseHref = this.platformStrategy.getBaseHref();\n    this._baseHref = Location.stripTrailingSlash(_stripIndexHtml(browserBaseHref));\n    this.platformStrategy.onPopState((ev) => {\n      ObservableWrapper.callEmit(this._subject, {'url': this.path(), 'pop': true, 'type': ev.type});\n    });\n  }\n\n  /**\n   * Returns the normalized URL path.\n   */\n  path(): string { return this.normalize(this.platformStrategy.path()); }\n\n  /**\n   * Given a string representing a URL, returns the normalized URL path without leading or\n   * trailing slashes\n   */\n  normalize(url: string): string {\n    return Location.stripTrailingSlash(_stripBaseHref(this._baseHref, _stripIndexHtml(url)));\n  }\n\n  /**\n   * Given a string representing a URL, returns the platform-specific external URL path.\n   * If the given URL doesn't begin with a leading slash (`'/'`), this method adds one\n   * before normalizing. This method will also add a hash if `HashLocationStrategy` is\n   * used, or the `APP_BASE_HREF` if the `PathLocationStrategy` is in use.\n   */\n  prepareExternalUrl(url: string): string {\n    if (url.length > 0 && !url.startsWith('/')) {\n      url = '/' + url;\n    }\n    return this.platformStrategy.prepareExternalUrl(url);\n  }\n\n  // TODO: rename this method to pushState\n  /**\n   * Changes the browsers URL to the normalized version of the given URL, and pushes a\n   * new item onto the platform's history.\n   */\n  go(path: string, query: string = ''): void {\n    this.platformStrategy.pushState(null, '', path, query);\n  }\n\n  /**\n   * Changes the browsers URL to the normalized version of the given URL, and replaces\n   * the top item on the platform's history stack.\n   */\n  replaceState(path: string, query: string = ''): void {\n    this.platformStrategy.replaceState(null, '', path, query);\n  }\n\n  /**\n   * Navigates forward in the platform's history.\n   */\n  forward(): void { this.platformStrategy.forward(); }\n\n  /**\n   * Navigates back in the platform's history.\n   */\n  back(): void { this.platformStrategy.back(); }\n\n  /**\n   * Subscribe to the platform's `popState` events.\n   */\n  subscribe(onNext: (value: any) => void, onThrow: (exception: any) => void = null,\n            onReturn: () => void = null): Object {\n    return ObservableWrapper.subscribe(this._subject, onNext, onThrow, onReturn);\n  }\n\n  /**\n   * Given a string of url parameters, prepend with '?' if needed, otherwise return parameters as\n   * is.\n   */\n  public static normalizeQueryParams(params: string): string {\n    return (params.length > 0 && params.substring(0, 1) != '?') ? ('?' + params) : params;\n  }\n\n  /**\n   * Given 2 parts of a url, join them with a slash if needed.\n   */\n  public static joinWithSlash(start: string, end: string): string {\n    if (start.length == 0) {\n      return end;\n    }\n    if (end.length == 0) {\n      return start;\n    }\n    var slashes = 0;\n    if (start.endsWith('/')) {\n      slashes++;\n    }\n    if (end.startsWith('/')) {\n      slashes++;\n    }\n    if (slashes == 2) {\n      return start + end.substring(1);\n    }\n    if (slashes == 1) {\n      return start + end;\n    }\n    return start + '/' + end;\n  }\n\n  /**\n   * If url has a trailing slash, remove it, otherwise return url as is.\n   */\n  public static stripTrailingSlash(url: string): string {\n    if (/\\/$/g.test(url)) {\n      url = url.substring(0, url.length - 1);\n    }\n    return url;\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\nstatic ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n{type: LocationStrategy, },\n];\n}\n\nfunction _stripBaseHref(baseHref: string, url: string): string {\n  if (baseHref.length > 0 && url.startsWith(baseHref)) {\n    return url.substring(baseHref.length);\n  }\n  return url;\n}\n\nfunction _stripIndexHtml(url: string): string {\n  if (/\\/index.html$/g.test(url)) {\n    // '/index.html'.length == 11\n    return url.substring(0, url.length - 11);\n  }\n  return url;\n}\n"]}