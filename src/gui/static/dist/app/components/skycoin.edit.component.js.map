{"version":3,"sources":["app/components/skycoin.edit.component.ts"],"names":[],"mappings":"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","file":"skycoin.edit.component.js","sourcesContent":["/**\r\n * Created by nakul.pandey@gmail.com on 01/01/17.\r\n */\r\n\r\nimport {Component, Input, EventEmitter, ElementRef, Output, OnInit} from '@angular/core';\r\nimport {Wallet} from '../model/wallet.pojo';\r\nimport {WalletService} from '../services/wallet.service';\r\ndeclare var toastr: any;\r\ndeclare var _: any;\r\n\r\n@Component({\r\n    selector: 'skycoin-edit',\r\n    styles: [\r\n        ` #skycoin-edit-ic {\r\n        margin-left: 10px;\r\n        color: #d9d9d9;\r\n        }\r\n        .skycoin-edit-comp {\r\n            padding:6px;\r\n            border-radius: 3px;\r\n        }\r\n        .active-skycoin-edit {\r\n            background-color: #f0f0f0;\r\n            border: 1px solid #d9d9d9;\r\n        }\r\n        input {\r\n            border-radius: 5px;\r\n            box-shadow: none;\r\n            border: 1px solid #dedede;\r\n            min-width: 5px;\r\n        }\r\n        .skycoin-edit-buttons {\r\n            background-color: #f0f0f0;\r\n            border: 1px solid #ccc;\r\n            border-top: none;\r\n            border-radius: 0 0 3px 3px;\r\n            box-shadow: 0 3px 6px rgba(111,111,111,0.2);\r\n            outline: none;\r\n            padding: 3px;\r\n            position: absolute;\r\n            margin-left: 6px;\r\n            z-index: 1;\r\n        }\r\n        .skycoin-edit-comp:hover {\r\n            border: 1px solid grey;\r\n        }\r\n        .skycoin-edit-comp:hover > skycoin-edit-ic {\r\n            display:block;\r\n        }\r\n        .skycoin-edit-save {\r\n            margin-right:3px;\r\n        }\r\n        .skycoin-edit-active {\r\n            background-color: #f0f0f0;\r\n            border: 1px solid #d9d9d9;\r\n        }\r\n        .ng-invalid {\r\n                background: #ffb8b8;\r\n            }\r\n        .err-bubble {\r\n            position: absolute;\r\n            margin: 16px 100px;\r\n            border: 1px solid red;\r\n            font-size: 14px;\r\n            background: #ffb8b8;\r\n            padding: 10px;\r\n            border-radius: 7px;\r\n        }\r\n       `\r\n    ],\r\n    template: `<span class='skycoin-edit-comp' [ngClass]=\"{'skycoin-edit-active':show}\">\r\n<input *ngIf='show' [ngClass]=\"{'ng-invalid': invalid}\" (ngModelChange)=\"validate($event)\" type='text' [(ngModel)]='text' />\r\n<div class='err-bubble' *ngIf=\"invalid\">{{error || \" must contain \" + min + \" to -\" + max +\" chars.\"}}</div>\r\n<i class=\"fa fa-edit\" (click)='makeEditable()' id='skycoin-edit-ic' *ngIf='!show'></i>\r\n<span *ngIf='!show' (click)='makeEditable()'>{{text || '-Empty Field-'}}</span>\r\n</span>\r\n<div class='skycoin-edit-buttons' *ngIf='show'>\r\n<button class='btn-x-sm' (click)='callSave()'><i class=\"fa fa-check\"></i></button>\r\n<button class='btn-x-sm' (click)='cancelEditable()'><i class=\"fa fa-times\"></i></button>\r\n</div>`,\r\n\r\n    host: {\r\n        \"(document: click)\": \"compareEvent($event)\",\r\n        \"(click)\": \"trackEvent($event)\"\r\n    },\r\n    providers: [WalletService]\r\n})\r\n\r\nexport class SkyCoinEditComponent implements OnInit {\r\n\r\n    @Input('text') text;\r\n    @Input('wallets') wallets: Wallet[];\r\n    @Input('walletId') walletId;\r\n\r\n    @Output() onWalletChanged = new EventEmitter();\r\n\r\n    originalText;\r\n    tracker;\r\n    el: ElementRef;\r\n    show = false;\r\n    m: Number = 3;\r\n    min = 0;\r\n    max = 100;\r\n    error;\r\n    regex;\r\n    invalid = false;\r\n\r\n    constructor(el: ElementRef, private _walletService: WalletService) {\r\n        this.el = el;\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.originalText = this.text;\r\n    }\r\n\r\n    validate(text) {\r\n        if (this.regex) {\r\n            var re = new RegExp('' + this.regex, \"ig\");\r\n            if (re.test(text)) {\r\n                this.invalid = false;\r\n            }\r\n            else {\r\n                this.invalid = true;\r\n            }\r\n        }\r\n        else {\r\n            if ((text.length <= this.max) && (text.length >= this.min)) {\r\n                this.invalid = false;\r\n            }\r\n            else {\r\n                this.invalid = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    makeEditable() {\r\n        if (this.show == false) {\r\n            this.show = true;\r\n        }\r\n    }\r\n\r\n    compareEvent(globalEvent) {\r\n        if (this.tracker != globalEvent && this.show) {\r\n            this.cancelEditable();\r\n        }\r\n    }\r\n\r\n    trackEvent(newHostEvent) {\r\n        this.tracker = newHostEvent;\r\n    }\r\n\r\n    cancelEditable() {\r\n        this.show = false;\r\n        this.invalid = false;\r\n        this.text = this.originalText;\r\n    }\r\n\r\n    callSave() {\r\n        if (!this.invalid && !this.isDuplicate(this.text)) {\r\n            var data = {};\r\n            data[\"newText\"] = this.text;\r\n            data[\"walletId\"] = this.walletId;\r\n\r\n            this._walletService.updateWallet(data).subscribe(response => {\r\n                    this.onWalletChanged.emit(data);\r\n                    this.show = false;\r\n                    toastr.info(\"Wallet name updated\");\r\n                },\r\n                err => {\r\n                    this.cancelEditable();\r\n                    toastr.error(\"Unable to update the name. Please try after some time\");\r\n                }\r\n            );\r\n        }\r\n    }\r\n\r\n    isDuplicate(text) {\r\n        var old = _.find(this.wallets, function (o) {\r\n            return (o.meta.label == text)\r\n        })\r\n\r\n        if (old) {\r\n            toastr.error(\"This wallet label is used already\");\r\n            this.cancelEditable();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n"],"sourceRoot":"/src"}