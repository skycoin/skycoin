{"version":3,"file":"view_builder.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/view_compiler/view_builder.ts"],"names":[],"mappings":"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","sourcesContent":["interface DecoratorInvocation {\n    type: Function;\n    args?: any[];\n  }\n  import {ChangeDetectionStrategy, ViewEncapsulation} from '@angular/core';\nimport {isDefaultChangeDetectionStrategy, ViewType} from '../../core_private';\n\nimport {isPresent, StringWrapper} from '../../src/facade/lang';\nimport {ListWrapper, StringMapWrapper, SetWrapper} from '../../src/facade/collection';\n\nimport * as o from '../output/output_ast';\nimport {Identifiers, identifierToken} from '../identifiers';\nimport {\n  ViewConstructorVars,\n  InjectMethodVars,\n  DetectChangesVars,\n  ViewTypeEnum,\n  ViewEncapsulationEnum,\n  ChangeDetectionStrategyEnum,\n  ViewProperties\n} from './constants';\n\nimport {CompileView} from './compile_view';\nimport {CompileElement, CompileNode} from './compile_element';\n\nimport {\n  TemplateAst,\n  TemplateAstVisitor,\n  NgContentAst,\n  EmbeddedTemplateAst,\n  ElementAst,\n  ReferenceAst,\n  VariableAst,\n  BoundEventAst,\n  BoundElementPropertyAst,\n  AttrAst,\n  BoundTextAst,\n  TextAst,\n  DirectiveAst,\n  BoundDirectivePropertyAst,\n  templateVisitAll,\n} from '../template_ast';\n\nimport {getViewFactoryName, createFlatArray, createDiTokenExpression} from './util';\n\nimport {\n  CompileIdentifierMetadata,\n  CompileDirectiveMetadata,\n  CompileTokenMetadata\n} from '../compile_metadata';\n\nconst IMPLICIT_TEMPLATE_VAR = '\\$implicit';\nconst CLASS_ATTR = 'class';\nconst STYLE_ATTR = 'style';\n\nvar parentRenderNodeVar = o.variable('parentRenderNode');\nvar rootSelectorVar = o.variable('rootSelector');\n\nexport class ViewCompileDependency {\n  constructor(public comp: CompileDirectiveMetadata,\n              public factoryPlaceholder: CompileIdentifierMetadata) {}\n}\n\nexport function buildView(view: CompileView, template: TemplateAst[],\n                          targetDependencies: ViewCompileDependency[]): number {\n  var builderVisitor = new ViewBuilderVisitor(view, targetDependencies);\n  templateVisitAll(builderVisitor, template, view.declarationElement.isNull() ?\n                                                 view.declarationElement :\n                                                 view.declarationElement.parent);\n  return builderVisitor.nestedViewCount;\n}\n\nexport function finishView(view: CompileView, targetStatements: o.Statement[]) {\n  view.afterNodes();\n  createViewTopLevelStmts(view, targetStatements);\n  view.nodes.forEach((node) => {\n    if (node instanceof CompileElement && node.hasEmbeddedView) {\n      finishView(node.embeddedView, targetStatements);\n    }\n  });\n}\n\nclass ViewBuilderVisitor implements TemplateAstVisitor {\n  nestedViewCount: number = 0;\n\n  constructor(public view: CompileView, public targetDependencies: ViewCompileDependency[]) {}\n\n  private _isRootNode(parent: CompileElement): boolean { return parent.view !== this.view; }\n\n  private _addRootNodeAndProject(node: CompileNode, ngContentIndex: number,\n                                 parent: CompileElement) {\n    var vcAppEl =\n        (node instanceof CompileElement && node.hasViewContainer) ? node.appElement : null;\n    if (this._isRootNode(parent)) {\n      // store appElement as root node only for ViewContainers\n      if (this.view.viewType !== ViewType.COMPONENT) {\n        this.view.rootNodesOrAppElements.push(isPresent(vcAppEl) ? vcAppEl : node.renderNode);\n      }\n    } else if (isPresent(parent.component) && isPresent(ngContentIndex)) {\n      parent.addContentNode(ngContentIndex, isPresent(vcAppEl) ? vcAppEl : node.renderNode);\n    }\n  }\n\n  private _getParentRenderNode(parent: CompileElement): o.Expression {\n    if (this._isRootNode(parent)) {\n      if (this.view.viewType === ViewType.COMPONENT) {\n        return parentRenderNodeVar;\n      } else {\n        // root node of an embedded/host view\n        return o.NULL_EXPR;\n      }\n    } else {\n      return isPresent(parent.component) &&\n                     parent.component.template.encapsulation !== ViewEncapsulation.Native ?\n                 o.NULL_EXPR :\n                 parent.renderNode;\n    }\n  }\n\n  visitBoundText(ast: BoundTextAst, parent: CompileElement): any {\n    return this._visitText(ast, '', ast.ngContentIndex, parent);\n  }\n  visitText(ast: TextAst, parent: CompileElement): any {\n    return this._visitText(ast, ast.value, ast.ngContentIndex, parent);\n  }\n  private _visitText(ast: TemplateAst, value: string, ngContentIndex: number,\n                     parent: CompileElement): o.Expression {\n    var fieldName = `_text_${this.view.nodes.length}`;\n    this.view.fields.push(\n        new o.ClassField(fieldName, o.importType(this.view.genConfig.renderTypes.renderText)));\n    var renderNode = o.THIS_EXPR.prop(fieldName);\n    var compileNode = new CompileNode(parent, this.view, this.view.nodes.length, renderNode, ast);\n    var createRenderNode =\n        o.THIS_EXPR.prop(fieldName)\n            .set(ViewProperties.renderer.callMethod(\n                'createText',\n                [\n                  this._getParentRenderNode(parent),\n                  o.literal(value),\n                  this.view.createMethod.resetDebugInfoExpr(this.view.nodes.length, ast)\n                ]))\n            .toStmt();\n    this.view.nodes.push(compileNode);\n    this.view.createMethod.addStmt(createRenderNode);\n    this._addRootNodeAndProject(compileNode, ngContentIndex, parent);\n    return renderNode;\n  }\n\n  visitNgContent(ast: NgContentAst, parent: CompileElement): any {\n    // the projected nodes originate from a different view, so we don't\n    // have debug information for them...\n    this.view.createMethod.resetDebugInfo(null, ast);\n    var parentRenderNode = this._getParentRenderNode(parent);\n    var nodesExpression = ViewProperties.projectableNodes.key(\n        o.literal(ast.index),\n        new o.ArrayType(o.importType(this.view.genConfig.renderTypes.renderNode)));\n    if (parentRenderNode !== o.NULL_EXPR) {\n      this.view.createMethod.addStmt(\n          ViewProperties.renderer.callMethod(\n                                     'projectNodes',\n                                     [\n                                       parentRenderNode,\n                                       o.importExpr(Identifiers.flattenNestedViewRenderNodes)\n                                           .callFn([nodesExpression])\n                                     ])\n              .toStmt());\n    } else if (this._isRootNode(parent)) {\n      if (this.view.viewType !== ViewType.COMPONENT) {\n        // store root nodes only for embedded/host views\n        this.view.rootNodesOrAppElements.push(nodesExpression);\n      }\n    } else {\n      if (isPresent(parent.component) && isPresent(ast.ngContentIndex)) {\n        parent.addContentNode(ast.ngContentIndex, nodesExpression);\n      }\n    }\n    return null;\n  }\n\n  visitElement(ast: ElementAst, parent: CompileElement): any {\n    var nodeIndex = this.view.nodes.length;\n    var createRenderNodeExpr;\n    var debugContextExpr = this.view.createMethod.resetDebugInfoExpr(nodeIndex, ast);\n    if (nodeIndex === 0 && this.view.viewType === ViewType.HOST) {\n      createRenderNodeExpr = o.THIS_EXPR.callMethod(\n          'selectOrCreateHostElement', [o.literal(ast.name), rootSelectorVar, debugContextExpr]);\n    } else {\n      createRenderNodeExpr = ViewProperties.renderer.callMethod(\n          'createElement',\n          [this._getParentRenderNode(parent), o.literal(ast.name), debugContextExpr]);\n    }\n    var fieldName = `_el_${nodeIndex}`;\n    this.view.fields.push(\n        new o.ClassField(fieldName, o.importType(this.view.genConfig.renderTypes.renderElement)));\n    this.view.createMethod.addStmt(o.THIS_EXPR.prop(fieldName).set(createRenderNodeExpr).toStmt());\n\n    var renderNode = o.THIS_EXPR.prop(fieldName);\n\n    var directives = ast.directives.map(directiveAst => directiveAst.directive);\n    var component = directives.find(directive => directive.isComponent);\n    var htmlAttrs = _readHtmlAttrs(ast.attrs);\n    var attrNameAndValues = _mergeHtmlAndDirectiveAttrs(htmlAttrs, directives);\n    for (var i = 0; i < attrNameAndValues.length; i++) {\n      var attrName = attrNameAndValues[i][0];\n      var attrValue = attrNameAndValues[i][1];\n      this.view.createMethod.addStmt(\n          ViewProperties.renderer.callMethod(\n                                     'setElementAttribute',\n                                     [renderNode, o.literal(attrName), o.literal(attrValue)])\n              .toStmt());\n    }\n    var compileElement =\n        new CompileElement(parent, this.view, nodeIndex, renderNode, ast, component, directives,\n                           ast.providers, ast.hasViewContainer, false, ast.references);\n    this.view.nodes.push(compileElement);\n    var compViewExpr: o.ReadVarExpr = null;\n    if (isPresent(component)) {\n      var nestedComponentIdentifier =\n          new CompileIdentifierMetadata({name: getViewFactoryName(component, 0)});\n      this.targetDependencies.push(new ViewCompileDependency(component, nestedComponentIdentifier));\n      compViewExpr = o.variable(`compView_${nodeIndex}`); // fix highlighting: `\n      compileElement.setComponentView(compViewExpr);\n      this.view.createMethod.addStmt(compViewExpr.set(o.importExpr(nestedComponentIdentifier)\n                                                          .callFn([\n                                                            ViewProperties.viewUtils,\n                                                            compileElement.injector,\n                                                            compileElement.appElement\n                                                          ]))\n                                         .toDeclStmt());\n    }\n    compileElement.beforeChildren();\n    this._addRootNodeAndProject(compileElement, ast.ngContentIndex, parent);\n    templateVisitAll(this, ast.children, compileElement);\n    compileElement.afterChildren(this.view.nodes.length - nodeIndex - 1);\n\n    if (isPresent(compViewExpr)) {\n      var codeGenContentNodes;\n      if (this.view.component.type.isHost) {\n        codeGenContentNodes = ViewProperties.projectableNodes;\n      } else {\n        codeGenContentNodes = o.literalArr(\n            compileElement.contentNodesByNgContentIndex.map(nodes => createFlatArray(nodes)));\n      }\n      this.view.createMethod.addStmt(\n          compViewExpr.callMethod('create',\n                                  [compileElement.getComponent(), codeGenContentNodes, o.NULL_EXPR])\n              .toStmt());\n    }\n    return null;\n  }\n\n  visitEmbeddedTemplate(ast: EmbeddedTemplateAst, parent: CompileElement): any {\n    var nodeIndex = this.view.nodes.length;\n    var fieldName = `_anchor_${nodeIndex}`;\n    this.view.fields.push(\n        new o.ClassField(fieldName, o.importType(this.view.genConfig.renderTypes.renderComment)));\n    this.view.createMethod.addStmt(\n        o.THIS_EXPR.prop(fieldName)\n            .set(ViewProperties.renderer.callMethod(\n                'createTemplateAnchor',\n                [\n                  this._getParentRenderNode(parent),\n                  this.view.createMethod.resetDebugInfoExpr(nodeIndex, ast)\n                ]))\n            .toStmt());\n    var renderNode = o.THIS_EXPR.prop(fieldName);\n\n    var templateVariableBindings = ast.variables.map(\n        varAst => [varAst.value.length > 0 ? varAst.value : IMPLICIT_TEMPLATE_VAR, varAst.name]);\n\n    var directives = ast.directives.map(directiveAst => directiveAst.directive);\n    var compileElement =\n        new CompileElement(parent, this.view, nodeIndex, renderNode, ast, null, directives,\n                           ast.providers, ast.hasViewContainer, true, ast.references);\n    this.view.nodes.push(compileElement);\n\n    this.nestedViewCount++;\n    var embeddedView = new CompileView(\n        this.view.component, this.view.genConfig, this.view.pipeMetas, o.NULL_EXPR,\n        this.view.viewIndex + this.nestedViewCount, compileElement, templateVariableBindings);\n    this.nestedViewCount += buildView(embeddedView, ast.children, this.targetDependencies);\n\n    compileElement.beforeChildren();\n    this._addRootNodeAndProject(compileElement, ast.ngContentIndex, parent);\n    compileElement.afterChildren(0);\n\n    return null;\n  }\n\n  visitAttr(ast: AttrAst, ctx: any): any { return null; }\n  visitDirective(ast: DirectiveAst, ctx: any): any { return null; }\n  visitEvent(ast: BoundEventAst, eventTargetAndNames: Map<string, BoundEventAst>): any {\n    return null;\n  }\n\n  visitReference(ast: ReferenceAst, ctx: any): any { return null; }\n  visitVariable(ast: VariableAst, ctx: any): any { return null; }\n  visitDirectiveProperty(ast: BoundDirectivePropertyAst, context: any): any { return null; }\n  visitElementProperty(ast: BoundElementPropertyAst, context: any): any { return null; }\n}\n\nfunction _mergeHtmlAndDirectiveAttrs(declaredHtmlAttrs: {[key: string]: string},\n                                     directives: CompileDirectiveMetadata[]): string[][] {\n  var result: {[key: string]: string} = {};\n  StringMapWrapper.forEach(declaredHtmlAttrs, (value, key) => { result[key] = value; });\n  directives.forEach(directiveMeta => {\n    StringMapWrapper.forEach(directiveMeta.hostAttributes, (value, name) => {\n      var prevValue = result[name];\n      result[name] = isPresent(prevValue) ? mergeAttributeValue(name, prevValue, value) : value;\n    });\n  });\n  return mapToKeyValueArray(result);\n}\n\nfunction _readHtmlAttrs(attrs: AttrAst[]): {[key: string]: string} {\n  var htmlAttrs: {[key: string]: string} = {};\n  attrs.forEach((ast) => { htmlAttrs[ast.name] = ast.value; });\n  return htmlAttrs;\n}\n\nfunction mergeAttributeValue(attrName: string, attrValue1: string, attrValue2: string): string {\n  if (attrName == CLASS_ATTR || attrName == STYLE_ATTR) {\n    return `${attrValue1} ${attrValue2}`;\n  } else {\n    return attrValue2;\n  }\n}\n\nfunction mapToKeyValueArray(data: {[key: string]: string}): string[][] {\n  var entryArray = [];\n  StringMapWrapper.forEach(data, (value, name) => { entryArray.push([name, value]); });\n  // We need to sort to get a defined output order\n  // for tests and for caching generated artifacts...\n  ListWrapper.sort(entryArray, (entry1, entry2) => StringWrapper.compare(entry1[0], entry2[0]));\n  var keyValueArray = [];\n  entryArray.forEach((entry) => { keyValueArray.push([entry[0], entry[1]]); });\n  return keyValueArray;\n}\n\nfunction createViewTopLevelStmts(view: CompileView, targetStatements: o.Statement[]) {\n  var nodeDebugInfosVar: o.Expression = o.NULL_EXPR;\n  if (view.genConfig.genDebugInfo) {\n    nodeDebugInfosVar = o.variable(\n        `nodeDebugInfos_${view.component.type.name}${view.viewIndex}`); // fix highlighting: `\n    targetStatements.push(\n        (<o.ReadVarExpr>nodeDebugInfosVar)\n            .set(o.literalArr(view.nodes.map(createStaticNodeDebugInfo),\n                              new o.ArrayType(new o.ExternalType(Identifiers.StaticNodeDebugInfo),\n                                              [o.TypeModifier.Const])))\n            .toDeclStmt(null, [o.StmtModifier.Final]));\n  }\n\n\n  var renderCompTypeVar: o.ReadVarExpr =\n      o.variable(`renderType_${view.component.type.name}`);  // fix highlighting: `\n  if (view.viewIndex === 0) {\n    targetStatements.push(renderCompTypeVar.set(o.NULL_EXPR)\n                              .toDeclStmt(o.importType(Identifiers.RenderComponentType)));\n  }\n\n  var viewClass = createViewClass(view, renderCompTypeVar, nodeDebugInfosVar);\n  targetStatements.push(viewClass);\n  targetStatements.push(createViewFactory(view, viewClass, renderCompTypeVar));\n}\n\nfunction createStaticNodeDebugInfo(node: CompileNode): o.Expression {\n  var compileElement = node instanceof CompileElement ? node : null;\n  var providerTokens: o.Expression[] = [];\n  var componentToken: o.Expression = o.NULL_EXPR;\n  var varTokenEntries = [];\n  if (isPresent(compileElement)) {\n    providerTokens = compileElement.getProviderTokens();\n    if (isPresent(compileElement.component)) {\n      componentToken = createDiTokenExpression(identifierToken(compileElement.component.type));\n    }\n    StringMapWrapper.forEach(compileElement.referenceTokens, (token, varName) => {\n      varTokenEntries.push(\n          [varName, isPresent(token) ? createDiTokenExpression(token) : o.NULL_EXPR]);\n    });\n  }\n  return o.importExpr(Identifiers.StaticNodeDebugInfo)\n      .instantiate(\n          [\n            o.literalArr(providerTokens, new o.ArrayType(o.DYNAMIC_TYPE, [o.TypeModifier.Const])),\n            componentToken,\n            o.literalMap(varTokenEntries, new o.MapType(o.DYNAMIC_TYPE, [o.TypeModifier.Const]))\n          ],\n          o.importType(Identifiers.StaticNodeDebugInfo, null, [o.TypeModifier.Const]));\n}\n\nfunction createViewClass(view: CompileView, renderCompTypeVar: o.ReadVarExpr,\n                         nodeDebugInfosVar: o.Expression): o.ClassStmt {\n  var viewConstructorArgs = [\n    new o.FnParam(ViewConstructorVars.viewUtils.name, o.importType(Identifiers.ViewUtils)),\n    new o.FnParam(ViewConstructorVars.parentInjector.name, o.importType(Identifiers.Injector)),\n    new o.FnParam(ViewConstructorVars.declarationEl.name, o.importType(Identifiers.AppElement))\n  ];\n  var superConstructorArgs = [\n    o.variable(view.className),\n    renderCompTypeVar,\n    ViewTypeEnum.fromValue(view.viewType),\n    ViewConstructorVars.viewUtils,\n    ViewConstructorVars.parentInjector,\n    ViewConstructorVars.declarationEl,\n    ChangeDetectionStrategyEnum.fromValue(getChangeDetectionMode(view))\n  ];\n  if (view.genConfig.genDebugInfo) {\n    superConstructorArgs.push(nodeDebugInfosVar);\n  }\n  var viewConstructor = new o.ClassMethod(null, viewConstructorArgs,\n                                          [o.SUPER_EXPR.callFn(superConstructorArgs).toStmt()]);\n\n  var viewMethods = [\n    new o.ClassMethod('createInternal', [new o.FnParam(rootSelectorVar.name, o.STRING_TYPE)],\n                      generateCreateMethod(view), o.importType(Identifiers.AppElement)),\n    new o.ClassMethod(\n        'injectorGetInternal',\n        [\n          new o.FnParam(InjectMethodVars.token.name, o.DYNAMIC_TYPE),\n          // Note: Can't use o.INT_TYPE here as the method in AppView uses number\n          new o.FnParam(InjectMethodVars.requestNodeIndex.name, o.NUMBER_TYPE),\n          new o.FnParam(InjectMethodVars.notFoundResult.name, o.DYNAMIC_TYPE)\n        ],\n        addReturnValuefNotEmpty(view.injectorGetMethod.finish(), InjectMethodVars.notFoundResult),\n        o.DYNAMIC_TYPE),\n    new o.ClassMethod('detectChangesInternal',\n                      [new o.FnParam(DetectChangesVars.throwOnChange.name, o.BOOL_TYPE)],\n                      generateDetectChangesMethod(view)),\n    new o.ClassMethod('dirtyParentQueriesInternal', [], view.dirtyParentQueriesMethod.finish()),\n    new o.ClassMethod('destroyInternal', [], view.destroyMethod.finish())\n  ].concat(view.eventHandlerMethods);\n  var superClass = view.genConfig.genDebugInfo ? Identifiers.DebugAppView : Identifiers.AppView;\n  var viewClass = new o.ClassStmt(view.className, o.importExpr(superClass, [getContextType(view)]),\n                                  view.fields, view.getters, viewConstructor,\n                                  viewMethods.filter((method) => method.body.length > 0));\n  return viewClass;\n}\n\nfunction createViewFactory(view: CompileView, viewClass: o.ClassStmt,\n                           renderCompTypeVar: o.ReadVarExpr): o.Statement {\n  var viewFactoryArgs = [\n    new o.FnParam(ViewConstructorVars.viewUtils.name, o.importType(Identifiers.ViewUtils)),\n    new o.FnParam(ViewConstructorVars.parentInjector.name, o.importType(Identifiers.Injector)),\n    new o.FnParam(ViewConstructorVars.declarationEl.name, o.importType(Identifiers.AppElement))\n  ];\n  var initRenderCompTypeStmts = [];\n  var templateUrlInfo;\n  if (view.component.template.templateUrl == view.component.type.moduleUrl) {\n    templateUrlInfo =\n        `${view.component.type.moduleUrl} class ${view.component.type.name} - inline template`;\n  } else {\n    templateUrlInfo = view.component.template.templateUrl;\n  }\n  if (view.viewIndex === 0) {\n    initRenderCompTypeStmts = [\n      new o.IfStmt(renderCompTypeVar.identical(o.NULL_EXPR),\n                   [\n                     renderCompTypeVar.set(ViewConstructorVars\n                                               .viewUtils.callMethod('createRenderComponentType',\n                                                                     [\n                                                                       o.literal(templateUrlInfo),\n                                                                       o.literal(view.component\n                                                                                     .template.ngContentSelectors.length),\n                                                                       ViewEncapsulationEnum\n                                                                           .fromValue(view.component.template.encapsulation),\n                                                                       view.styles\n                                                                     ]))\n                         .toStmt()\n                   ])\n    ];\n  }\n  return o.fn(viewFactoryArgs, initRenderCompTypeStmts.concat([\n            new o.ReturnStatement(o.variable(viewClass.name)\n                                      .instantiate(viewClass.constructorMethod.params.map(\n                                          (param) => o.variable(param.name))))\n          ]),\n              o.importType(Identifiers.AppView, [getContextType(view)]))\n      .toDeclStmt(view.viewFactory.name, [o.StmtModifier.Final]);\n}\n\nfunction generateCreateMethod(view: CompileView): o.Statement[] {\n  var parentRenderNodeExpr: o.Expression = o.NULL_EXPR;\n  var parentRenderNodeStmts = [];\n  if (view.viewType === ViewType.COMPONENT) {\n    parentRenderNodeExpr = ViewProperties.renderer.callMethod(\n        'createViewRoot', [o.THIS_EXPR.prop('declarationAppElement').prop('nativeElement')]);\n    parentRenderNodeStmts = [\n      parentRenderNodeVar.set(parentRenderNodeExpr)\n          .toDeclStmt(o.importType(view.genConfig.renderTypes.renderNode), [o.StmtModifier.Final])\n    ];\n  }\n  var resultExpr: o.Expression;\n  if (view.viewType === ViewType.HOST) {\n    resultExpr = (<CompileElement>view.nodes[0]).appElement;\n  } else {\n    resultExpr = o.NULL_EXPR;\n  }\n  return parentRenderNodeStmts.concat(view.createMethod.finish())\n      .concat([\n        o.THIS_EXPR.callMethod('init',\n                               [\n                                 createFlatArray(view.rootNodesOrAppElements),\n                                 o.literalArr(view.nodes.map(node => node.renderNode)),\n                                 o.literalArr(view.disposables),\n                                 o.literalArr(view.subscriptions)\n                               ])\n            .toStmt(),\n        new o.ReturnStatement(resultExpr)\n      ]);\n}\n\nfunction generateDetectChangesMethod(view: CompileView): o.Statement[] {\n  var stmts = [];\n  if (view.detectChangesInInputsMethod.isEmpty() && view.updateContentQueriesMethod.isEmpty() &&\n      view.afterContentLifecycleCallbacksMethod.isEmpty() &&\n      view.detectChangesRenderPropertiesMethod.isEmpty() &&\n      view.updateViewQueriesMethod.isEmpty() && view.afterViewLifecycleCallbacksMethod.isEmpty()) {\n    return stmts;\n  }\n  ListWrapper.addAll(stmts, view.detectChangesInInputsMethod.finish());\n  stmts.push(\n      o.THIS_EXPR.callMethod('detectContentChildrenChanges', [DetectChangesVars.throwOnChange])\n          .toStmt());\n  var afterContentStmts = view.updateContentQueriesMethod.finish().concat(\n      view.afterContentLifecycleCallbacksMethod.finish());\n  if (afterContentStmts.length > 0) {\n    stmts.push(new o.IfStmt(o.not(DetectChangesVars.throwOnChange), afterContentStmts));\n  }\n  ListWrapper.addAll(stmts, view.detectChangesRenderPropertiesMethod.finish());\n  stmts.push(o.THIS_EXPR.callMethod('detectViewChildrenChanges', [DetectChangesVars.throwOnChange])\n                 .toStmt());\n  var afterViewStmts =\n      view.updateViewQueriesMethod.finish().concat(view.afterViewLifecycleCallbacksMethod.finish());\n  if (afterViewStmts.length > 0) {\n    stmts.push(new o.IfStmt(o.not(DetectChangesVars.throwOnChange), afterViewStmts));\n  }\n\n  var varStmts = [];\n  var readVars = o.findReadVarNames(stmts);\n  if (SetWrapper.has(readVars, DetectChangesVars.changed.name)) {\n    varStmts.push(DetectChangesVars.changed.set(o.literal(true)).toDeclStmt(o.BOOL_TYPE));\n  }\n  if (SetWrapper.has(readVars, DetectChangesVars.changes.name)) {\n    varStmts.push(DetectChangesVars.changes.set(o.NULL_EXPR)\n                      .toDeclStmt(new o.MapType(o.importType(Identifiers.SimpleChange))));\n  }\n  if (SetWrapper.has(readVars, DetectChangesVars.valUnwrapper.name)) {\n    varStmts.push(\n        DetectChangesVars.valUnwrapper.set(o.importExpr(Identifiers.ValueUnwrapper).instantiate([]))\n            .toDeclStmt(null, [o.StmtModifier.Final]));\n  }\n  return varStmts.concat(stmts);\n}\n\nfunction addReturnValuefNotEmpty(statements: o.Statement[], value: o.Expression): o.Statement[] {\n  if (statements.length > 0) {\n    return statements.concat([new o.ReturnStatement(value)]);\n  } else {\n    return statements;\n  }\n}\n\nfunction getContextType(view: CompileView): o.Type {\n  if (view.viewType === ViewType.COMPONENT) {\n    return o.importType(view.component.type);\n  }\n  return o.DYNAMIC_TYPE;\n}\n\nfunction getChangeDetectionMode(view: CompileView): ChangeDetectionStrategy {\n  var mode: ChangeDetectionStrategy;\n  if (view.viewType === ViewType.COMPONENT) {\n    mode = isDefaultChangeDetectionStrategy(view.component.changeDetection) ?\n               ChangeDetectionStrategy.CheckAlways :\n               ChangeDetectionStrategy.CheckOnce;\n  } else {\n    mode = ChangeDetectionStrategy.CheckAlways;\n  }\n  return mode;\n}\n"]}