{"version":3,"file":"shared.js","sourceRoot":"","sources":["../../../../../../../modules/@angular/common/src/forms/directives/shared.ts"],"names":[],"mappings":"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","sourcesContent":["interface DecoratorInvocation {\n    type: Function;\n    args?: any[];\n  }\n  import {ListWrapper, StringMapWrapper} from '../../../src/facade/collection';\nimport {isBlank, isPresent, looseIdentical, hasConstructor} from '../../../src/facade/lang';\nimport {BaseException} from '../../../src/facade/exceptions';\n\nimport {ControlContainer} from './control_container';\nimport {NgControl} from './ng_control';\nimport {AbstractControlDirective} from './abstract_control_directive';\nimport {NgControlGroup} from './ng_control_group';\nimport {Control, ControlGroup} from '../model';\nimport {Validators} from '../validators';\nimport {ControlValueAccessor} from './control_value_accessor';\nimport {DefaultValueAccessor} from './default_value_accessor';\nimport {NumberValueAccessor} from './number_value_accessor';\nimport {CheckboxControlValueAccessor} from './checkbox_value_accessor';\nimport {SelectControlValueAccessor} from './select_control_value_accessor';\nimport {RadioControlValueAccessor} from './radio_control_value_accessor';\nimport {normalizeValidator, normalizeAsyncValidator} from './normalize_validator';\nimport {ValidatorFn, AsyncValidatorFn} from './validators';\n\n\nexport function controlPath(name: string, parent: ControlContainer): string[] {\n  var p = ListWrapper.clone(parent.path);\n  p.push(name);\n  return p;\n}\n\nexport function setUpControl(control: Control, dir: NgControl): void {\n  if (isBlank(control)) _throwError(dir, \"Cannot find control\");\n  if (isBlank(dir.valueAccessor)) _throwError(dir, \"No value accessor for\");\n\n  control.validator = Validators.compose([control.validator, dir.validator]);\n  control.asyncValidator = Validators.composeAsync([control.asyncValidator, dir.asyncValidator]);\n  dir.valueAccessor.writeValue(control.value);\n\n  // view -> model\n  dir.valueAccessor.registerOnChange((newValue: any) => {\n    dir.viewToModelUpdate(newValue);\n    control.updateValue(newValue, {emitModelToViewChange: false});\n    control.markAsDirty();\n  });\n\n  // model -> view\n  control.registerOnChange((newValue: any) => dir.valueAccessor.writeValue(newValue));\n\n  // touched\n  dir.valueAccessor.registerOnTouched(() => control.markAsTouched());\n}\n\nexport function setUpControlGroup(control: ControlGroup, dir: NgControlGroup) {\n  if (isBlank(control)) _throwError(dir, \"Cannot find control\");\n  control.validator = Validators.compose([control.validator, dir.validator]);\n  control.asyncValidator = Validators.composeAsync([control.asyncValidator, dir.asyncValidator]);\n}\n\nfunction _throwError(dir: AbstractControlDirective, message: string): void {\n  var path = dir.path.join(\" -> \");\n  throw new BaseException(`${message} '${path}'`);\n}\n\nexport function composeValidators(validators: /* Array<Validator|Function> */ any[]): ValidatorFn {\n  return isPresent(validators) ? Validators.compose(validators.map(normalizeValidator)) : null;\n}\n\nexport function composeAsyncValidators(\n    validators: /* Array<Validator|Function> */ any[]): AsyncValidatorFn {\n  return isPresent(validators) ? Validators.composeAsync(validators.map(normalizeAsyncValidator)) :\n                                 null;\n}\n\nexport function isPropertyUpdated(changes: {[key: string]: any}, viewModel: any): boolean {\n  if (!StringMapWrapper.contains(changes, \"model\")) return false;\n  var change = changes[\"model\"];\n\n  if (change.isFirstChange()) return true;\n  return !looseIdentical(viewModel, change.currentValue);\n}\n\n// TODO: vsavkin remove it once https://github.com/angular/angular/issues/3011 is implemented\nexport function selectValueAccessor(dir: NgControl,\n                                    valueAccessors: ControlValueAccessor[]): ControlValueAccessor {\n  if (isBlank(valueAccessors)) return null;\n\n  var defaultAccessor: ControlValueAccessor;\n  var builtinAccessor: ControlValueAccessor;\n  var customAccessor: ControlValueAccessor;\n  valueAccessors.forEach((v: ControlValueAccessor) => {\n    if (hasConstructor(v, DefaultValueAccessor)) {\n      defaultAccessor = v;\n\n    } else if (hasConstructor(v, CheckboxControlValueAccessor) ||\n               hasConstructor(v, NumberValueAccessor) ||\n               hasConstructor(v, SelectControlValueAccessor) ||\n               hasConstructor(v, RadioControlValueAccessor)) {\n      if (isPresent(builtinAccessor))\n        _throwError(dir, \"More than one built-in value accessor matches\");\n      builtinAccessor = v;\n\n    } else {\n      if (isPresent(customAccessor))\n        _throwError(dir, \"More than one custom value accessor matches\");\n      customAccessor = v;\n    }\n  });\n\n  if (isPresent(customAccessor)) return customAccessor;\n  if (isPresent(builtinAccessor)) return builtinAccessor;\n  if (isPresent(defaultAccessor)) return defaultAccessor;\n\n  _throwError(dir, \"No valid value accessor for\");\n  return null;\n}\n"]}