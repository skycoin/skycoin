{"version":3,"file":"reflective_exceptions.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/di/reflective_exceptions.ts"],"names":[],"mappings":"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","sourcesContent":["interface DecoratorInvocation {\n    type: Function;\n    args?: any[];\n  }\n  import {ListWrapper} from '../../src/facade/collection';\nimport {stringify, isBlank} from '../../src/facade/lang';\nimport {BaseException, WrappedException} from '../../src/facade/exceptions';\nimport {ReflectiveKey} from './reflective_key';\nimport {ReflectiveInjector} from './reflective_injector';\n\nfunction findFirstClosedCycle(keys: any[]): any[] {\n  var res = [];\n  for (var i = 0; i < keys.length; ++i) {\n    if (ListWrapper.contains(res, keys[i])) {\n      res.push(keys[i]);\n      return res;\n    } else {\n      res.push(keys[i]);\n    }\n  }\n  return res;\n}\n\nfunction constructResolvingPath(keys: any[]): string {\n  if (keys.length > 1) {\n    var reversed = findFirstClosedCycle(ListWrapper.reversed(keys));\n    var tokenStrs = reversed.map(k => stringify(k.token));\n    return \" (\" + tokenStrs.join(' -> ') + \")\";\n  } else {\n    return \"\";\n  }\n}\n\n\n/**\n * Base class for all errors arising from misconfigured providers.\n */\nexport class AbstractProviderError extends BaseException {\n  /** @internal */\n  message: string;\n\n  /** @internal */\n  keys: ReflectiveKey[];\n\n  /** @internal */\n  injectors: ReflectiveInjector[];\n\n  /** @internal */\n  constructResolvingMessage: Function;\n\n  constructor(injector: ReflectiveInjector, key: ReflectiveKey,\n              constructResolvingMessage: Function) {\n    super(\"DI Exception\");\n    this.keys = [key];\n    this.injectors = [injector];\n    this.constructResolvingMessage = constructResolvingMessage;\n    this.message = this.constructResolvingMessage(this.keys);\n  }\n\n  addKey(injector: ReflectiveInjector, key: ReflectiveKey): void {\n    this.injectors.push(injector);\n    this.keys.push(key);\n    this.message = this.constructResolvingMessage(this.keys);\n  }\n\n  get context() { return this.injectors[this.injectors.length - 1].debugContext(); }\n}\n\n/**\n * Thrown when trying to retrieve a dependency by `Key` from {@link Injector}, but the\n * {@link Injector} does not have a {@link Provider} for {@link Key}.\n *\n * ### Example ([live demo](http://plnkr.co/edit/vq8D3FRB9aGbnWJqtEPE?p=preview))\n *\n * ```typescript\n * class A {\n *   constructor(b:B) {}\n * }\n *\n * expect(() => Injector.resolveAndCreate([A])).toThrowError();\n * ```\n */\nexport class NoProviderError extends AbstractProviderError {\n  constructor(injector: ReflectiveInjector, key: ReflectiveKey) {\n    super(injector, key, function(keys: any[]) {\n      var first = stringify(ListWrapper.first(keys).token);\n      return `No provider for ${first}!${constructResolvingPath(keys)}`;\n    });\n  }\n}\n\n/**\n * Thrown when dependencies form a cycle.\n *\n * ### Example ([live demo](http://plnkr.co/edit/wYQdNos0Tzql3ei1EV9j?p=info))\n *\n * ```typescript\n * var injector = Injector.resolveAndCreate([\n *   provide(\"one\", {useFactory: (two) => \"two\", deps: [[new Inject(\"two\")]]}),\n *   provide(\"two\", {useFactory: (one) => \"one\", deps: [[new Inject(\"one\")]]})\n * ]);\n *\n * expect(() => injector.get(\"one\")).toThrowError();\n * ```\n *\n * Retrieving `A` or `B` throws a `CyclicDependencyError` as the graph above cannot be constructed.\n */\nexport class CyclicDependencyError extends AbstractProviderError {\n  constructor(injector: ReflectiveInjector, key: ReflectiveKey) {\n    super(injector, key, function(keys: any[]) {\n      return `Cannot instantiate cyclic dependency!${constructResolvingPath(keys)}`;\n    });\n  }\n}\n\n/**\n * Thrown when a constructing type returns with an Error.\n *\n * The `InstantiationError` class contains the original error plus the dependency graph which caused\n * this object to be instantiated.\n *\n * ### Example ([live demo](http://plnkr.co/edit/7aWYdcqTQsP0eNqEdUAf?p=preview))\n *\n * ```typescript\n * class A {\n *   constructor() {\n *     throw new Error('message');\n *   }\n * }\n *\n * var injector = Injector.resolveAndCreate([A]);\n\n * try {\n *   injector.get(A);\n * } catch (e) {\n *   expect(e instanceof InstantiationError).toBe(true);\n *   expect(e.originalException.message).toEqual(\"message\");\n *   expect(e.originalStack).toBeDefined();\n * }\n * ```\n */\nexport class InstantiationError extends WrappedException {\n  /** @internal */\n  keys: ReflectiveKey[];\n\n  /** @internal */\n  injectors: ReflectiveInjector[];\n\n  constructor(injector: ReflectiveInjector, originalException, originalStack, key: ReflectiveKey) {\n    super(\"DI Exception\", originalException, originalStack, null);\n    this.keys = [key];\n    this.injectors = [injector];\n  }\n\n  addKey(injector: ReflectiveInjector, key: ReflectiveKey): void {\n    this.injectors.push(injector);\n    this.keys.push(key);\n  }\n\n  get wrapperMessage(): string {\n    var first = stringify(ListWrapper.first(this.keys).token);\n    return `Error during instantiation of ${first}!${constructResolvingPath(this.keys)}.`;\n  }\n\n  get causeKey(): ReflectiveKey { return this.keys[0]; }\n\n  get context() { return this.injectors[this.injectors.length - 1].debugContext(); }\n}\n\n/**\n * Thrown when an object other then {@link Provider} (or `Type`) is passed to {@link Injector}\n * creation.\n *\n * ### Example ([live demo](http://plnkr.co/edit/YatCFbPAMCL0JSSQ4mvH?p=preview))\n *\n * ```typescript\n * expect(() => Injector.resolveAndCreate([\"not a type\"])).toThrowError();\n * ```\n */\nexport class InvalidProviderError extends BaseException {\n  constructor(provider) {\n    super(\"Invalid provider - only instances of Provider and Type are allowed, got: \" +\n          provider.toString());\n  }\n}\n\n/**\n * Thrown when the class has no annotation information.\n *\n * Lack of annotation information prevents the {@link Injector} from determining which dependencies\n * need to be injected into the constructor.\n *\n * ### Example ([live demo](http://plnkr.co/edit/rHnZtlNS7vJOPQ6pcVkm?p=preview))\n *\n * ```typescript\n * class A {\n *   constructor(b) {}\n * }\n *\n * expect(() => Injector.resolveAndCreate([A])).toThrowError();\n * ```\n *\n * This error is also thrown when the class not marked with {@link Injectable} has parameter types.\n *\n * ```typescript\n * class B {}\n *\n * class A {\n *   constructor(b:B) {} // no information about the parameter types of A is available at runtime.\n * }\n *\n * expect(() => Injector.resolveAndCreate([A,B])).toThrowError();\n * ```\n */\nexport class NoAnnotationError extends BaseException {\n  constructor(typeOrFunc, params: any[][]) {\n    super(NoAnnotationError._genMessage(typeOrFunc, params));\n  }\n\n  private static _genMessage(typeOrFunc, params: any[][]) {\n    var signature = [];\n    for (var i = 0, ii = params.length; i < ii; i++) {\n      var parameter = params[i];\n      if (isBlank(parameter) || parameter.length == 0) {\n        signature.push('?');\n      } else {\n        signature.push(parameter.map(stringify).join(' '));\n      }\n    }\n    return \"Cannot resolve all parameters for '\" + stringify(typeOrFunc) + \"'(\" +\n           signature.join(', ') + \"). \" +\n           \"Make sure that all the parameters are decorated with Inject or have valid type annotations and that '\" +\n           stringify(typeOrFunc) + \"' is decorated with Injectable.\";\n  }\n}\n\n/**\n * Thrown when getting an object by index.\n *\n * ### Example ([live demo](http://plnkr.co/edit/bRs0SX2OTQiJzqvjgl8P?p=preview))\n *\n * ```typescript\n * class A {}\n *\n * var injector = Injector.resolveAndCreate([A]);\n *\n * expect(() => injector.getAt(100)).toThrowError();\n * ```\n */\nexport class OutOfBoundsError extends BaseException {\n  constructor(index) { super(`Index ${index} is out-of-bounds.`); }\n}\n\n// TODO: add a working example after alpha38 is released\n/**\n * Thrown when a multi provider and a regular provider are bound to the same token.\n *\n * ### Example\n *\n * ```typescript\n * expect(() => Injector.resolveAndCreate([\n *   new Provider(\"Strings\", {useValue: \"string1\", multi: true}),\n *   new Provider(\"Strings\", {useValue: \"string2\", multi: false})\n * ])).toThrowError();\n * ```\n */\nexport class MixingMultiProvidersWithRegularProvidersError extends BaseException {\n  constructor(provider1, provider2) {\n    super(\"Cannot mix multi providers and regular providers, got: \" + provider1.toString() + \" \" +\n          provider2.toString());\n  }\n}\n"]}