{"version":3,"file":"browser_details.js","sourceRoot":"","sources":["../../../../../../modules/@angular/platform-browser/src/animate/browser_details.ts"],"names":[],"mappings":"OAIS,EAAC,UAAU,EAAC,MAAM,eAAe;OACnC,EAAC,IAAI,EAAC,MAAM,uBAAuB;OACnC,EAAC,MAAM,EAAC,MAAM,oBAAoB;AACzC;IAGE;QAFA,6BAAwB,GAAG,KAAK,CAAC;QAEjB,IAAI,CAAC,4BAA4B,EAAE,CAAC;IAAC,CAAC;IAEtD;;;OAGG;IACH,4BAA4B;QAC1B,IAAI,GAAG,GAAG,MAAM,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QACxC,MAAM,EAAE,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,EACZ;mDACyB,CAAC,CAAC;QACjD,6DAA6D;QAC7D,IAAI,CAAC,GAAG,CAAC,CAAC,SAAc;YACtB,MAAM,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,eAAe,EAAE,CAAC,KAAU;gBAC3C,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,WAAW,GAAG,IAAI,CAAC,CAAC;gBACnD,IAAI,CAAC,wBAAwB,GAAG,OAAO,IAAI,CAAC,CAAC;gBAC7C,MAAM,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YACvB,CAAC,CAAC,CAAC;YACH,MAAM,EAAE,CAAC,QAAQ,CAAC,GAAG,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;QACzC,CAAC,EAAE,CAAC,CAAC,CAAC;IACR,CAAC;IAED,GAAG,CAAC,QAAkB,EAAE,MAAM,GAAW,CAAC;QACxC,IAAI,KAAK,GAAa,IAAI,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QACrD,MAAM,CAAC,MAAM,KAAK,CAAC,MAAM,EAAE,CAAC;IAC9B,CAAC;AAMH,CAAC;AALM,yBAAU,GAA0B;IAC3C,EAAE,IAAI,EAAE,UAAU,EAAE;CACnB,CAAC;AACK,6BAAc,GAA2D,EAC/E,CACA;AAED;IAEE,YAAmB,QAAkB,EAAS,MAAc;QAAzC,aAAQ,GAAR,QAAQ,CAAU;QAAS,WAAM,GAAN,MAAM,CAAQ;QAAI,IAAI,CAAC,IAAI,EAAE,CAAC;IAAC,CAAC;IACtE,IAAI;QACV,IAAI,CAAC,cAAc;YACf,MAAM,EAAE,CAAC,qBAAqB,CAAC,CAAC,SAAiB,KAAK,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;IACxF,CAAC;IACO,UAAU,CAAC,SAAiB;QAClC,IAAI,CAAC,MAAM,EAAE,CAAC;QACd,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YACpB,IAAI,CAAC,IAAI,EAAE,CAAC;QACd,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC3B,CAAC;IACH,CAAC;IACD,MAAM;QACJ,MAAM,EAAE,CAAC,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QACnD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IAC7B,CAAC;AACH,CAAC;AAAA","sourcesContent":["interface DecoratorInvocation {\n    type: Function;\n    args?: any[];\n  }\n  import {Injectable} from '@angular/core';\nimport {Math} from '../../src/facade/math';\nimport {getDOM} from '../dom/dom_adapter';\nexport class BrowserDetails {\n  elapsedTimeIncludesDelay = false;\n\n  constructor() { this.doesElapsedTimeIncludesDelay(); }\n\n  /**\n   * Determines if `event.elapsedTime` includes transition delay in the current browser.  At this\n   * time, Chrome and Opera seem to be the only browsers that include this.\n   */\n  doesElapsedTimeIncludesDelay(): void {\n    var div = getDOM().createElement('div');\n    getDOM().setAttribute(div, 'style',\n                          `position: absolute; top: -9999px; left: -9999px; width: 1px;\n      height: 1px; transition: all 1ms linear 1ms;`);\n    // Firefox requires that we wait for 2 frames for some reason\n    this.raf((timestamp: any) => {\n      getDOM().on(div, 'transitionend', (event: any) => {\n        var elapsed = Math.round(event.elapsedTime * 1000);\n        this.elapsedTimeIncludesDelay = elapsed == 2;\n        getDOM().remove(div);\n      });\n      getDOM().setStyle(div, 'width', '2px');\n    }, 2);\n  }\n\n  raf(callback: Function, frames: number = 1): Function {\n    var queue: RafQueue = new RafQueue(callback, frames);\n    return () => queue.cancel();\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\nstatic ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n];\n}\n\nclass RafQueue {\n  currentFrameId: number;\n  constructor(public callback: Function, public frames: number) { this._raf(); }\n  private _raf() {\n    this.currentFrameId =\n        getDOM().requestAnimationFrame((timestamp: number) => this._nextFrame(timestamp));\n  }\n  private _nextFrame(timestamp: number) {\n    this.frames--;\n    if (this.frames > 0) {\n      this._raf();\n    } else {\n      this.callback(timestamp);\n    }\n  }\n  cancel() {\n    getDOM().cancelAnimationFrame(this.currentFrameId);\n    this.currentFrameId = null;\n  }\n}\n"]}